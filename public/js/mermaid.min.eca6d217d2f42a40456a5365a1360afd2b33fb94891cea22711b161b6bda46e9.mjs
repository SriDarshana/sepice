(function(window){"use strict";const elementCode=".mermaid",getPreferedTheme=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",forEachDiagram=func=>new Promise((resolve,reject)=>{try{var els=document.querySelectorAll(elementCode),count=els.length;els.forEach(element=>{func(element),count--,count==0&&resolve()})}catch(error){reject(error)}}),getStyles=theme=>{const themeElement=document.getElementById(`mermaid-${theme}-theme`);return getComputedStyle(themeElement)},kebabToCamel=str=>str.replace(/-([a-z])/g,g=>g[1].toUpperCase()),removeQuotes=str=>str.replace(/['"]/g,""),getMermaidStyle=cssStyles=>{const mermaidThemeVariables=["--mermaid-dark-mode","--mermaid-background","--mermaid-font-family","--mermaid-font-size","--mermaid-primary-color","--mermaid-primary-text-color","--mermaid-secondary-color","--mermaid-primary-border-color","--mermaid-secondary-border-color","--mermaid-secondary-text-color","--mermaid-tertiary-color","--mermaid-tertiary-border-color","--mermaid-tertiary-text-color","--mermaid-note-bkg-color","--mermaid-note-text-color","--mermaid-note-border-color","--mermaid-line-color","--mermaid-text-color","--mermaid-main-bkg","--mermaid-error-bkg-color","--mermaid-error-text-color","--mermaid-node-border","--mermaid-cluster-bkg","--mermaid-cluster-border","--mermaid-default-link-color","--mermaid-title-color","--mermaid-edge-label-background","--mermaid-node-text-color","--mermaid-actor-bkg","--mermaid-actor-border","--mermaid-actor-text-color","--mermaid-actor-line-color","--mermaid-signal-color","--mermaid-signal-text-color","--mermaid-label-box-bkg-color","--mermaid-label-box-border-color","--mermaid-label-text-color","--mermaid-loop-text-color","--mermaid-activation-border-color","--mermaid-activation-bkg-color","--mermaid-sequence-number-color","--mermaid-pie1","--mermaid-pie2","--mermaid-pie3","--mermaid-pie4","--mermaid-pie5","--mermaid-pie6","--mermaid-pie7","--mermaid-pie8","--mermaid-pie9","--mermaid-pie10","--mermaid-pie11","--mermaid-pie12","--mermaid-pie-title-text-size","--mermaid-pie-title-text-color","--mermaid-pie-section-text-size","--mermaid-pie-section-text-color","--mermaid-pie-legend-text-size","--mermaid-pie-legend-text-color","--mermaid-pie-stroke-color","--mermaid-pie-stroke-width","--mermaid-pie-outer-stroke-width","--mermaid-pie-outer-stroke-color","--mermaid-pie-opacity","--mermaid-label-color","--mermaid-alt-background","--mermaid-class-text","--mermaid-fill-type0","--mermaid-fill-type1","--mermaid-fill-type2","--mermaid-fill-type3","--mermaid-fill-type4","--mermaid-fill-type5","--mermaid-fill-type6","--mermaid-fill-type7"];var themeVariables={};return mermaidThemeVariables.forEach(themeProp=>{const value=cssStyles.getPropertyValue(themeProp).trim();if(value){const originalVariableName=kebabToCamel(themeProp.replace("--mermaid-",""));themeVariables[originalVariableName]=value}}),themeVariables},loadMermaid=dark=>{const style=getStyles(dark?"dark":"light"),mermaidTheme=removeQuotes(style.getPropertyValue("--mermaid-theme")),mermaidStyle=getMermaidStyle(style),params={theme:mermaidTheme,themeVariables:mermaidStyle,startOnLoad:!0,layout:"dagre",look:"classic"};window.mermaid.initialize(params),window.mermaid.init(params,document.querySelectorAll(elementCode))},updateTheme=theme=>{forEachDiagram(element=>{element.getAttribute("data-original-code")!=null&&(element.removeAttribute("data-processed"),element.innerHTML=element.getAttribute("data-original-code"))}).then(()=>{loadMermaid(theme==="dark")}).catch(console.error)};document.querySelectorAll("[data-bs-theme-value]").forEach(toggle=>{toggle.addEventListener("click",()=>{const theme=toggle.getAttribute("data-bs-theme-value");updateTheme(theme==="auto"?getPreferedTheme():theme)})}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{document.documentElement.getAttribute("data-bs-theme")==="auto"&&updateTheme(getPreferedTheme())});const createPseudoStyledElements=()=>{const themes=["light","dark"];themes.forEach(theme=>{const themeElement=document.createElement("div");themeElement.id=`mermaid-${theme}-theme`,themeElement.setAttribute("data-bs-theme",theme),themeElement.setAttribute("data-mermaid-theme",theme),themeElement.style.display="none",document.body.appendChild(themeElement)})};document.addEventListener("DOMContentLoaded",()=>{createPseudoStyledElements(),forEachDiagram(element=>{element.setAttribute("data-original-code",element.innerHTML)}).catch(console.error),updateTheme(document.documentElement.getAttribute("data-bs-theme"))})})(window);const minScale=4,maxScale=.5,step=1.2,zoomFactor=.02;let current,mouseX,mouseY,touchX,touchY;function updateTransform(wrapper,translateX,translateY,scale,ease){setScale(wrapper,scale),ease?wrapper.style.transition="all 0.3s ease-in-out":wrapper.style.transition="",wrapper.style.transform=`translate(${translateX}px, ${translateY}px) scale(${scale})`}function getTranslateXY(element){const style=window.getComputedStyle(element),matrix=new DOMMatrixReadOnly(style.transform);return{translateX:matrix.m41,translateY:matrix.m42}}function getScale(wrapper){const scale=wrapper.getAttribute("data-scale")||1;return scale}function setScale(wrapper,scale){wrapper.setAttribute("data-scale",scale)}function expand(wrapper){wrapper.style.transformOrigin="",updateTransform(wrapper,0,0,1,!0)}function zoomIn(wrapper){const scale=Math.min(getScale(wrapper)*step,minScale),c=getTranslateXY(wrapper);updateTransform(wrapper,c.translateX,c.translateY,scale,!0)}function zoomOut(wrapper){const scale=Math.max(getScale(wrapper)/step,maxScale),c=getTranslateXY(wrapper);updateTransform(wrapper,c.translateX,c.translateY,scale,!0)}function handleMousedown(wrapper,e){e.preventDefault(),wrapper.parentElement.classList.add("grabbing"),current=getTranslateXY(wrapper),mouseX=e.clientX,mouseY=e.clientY}function handleMousemove(wrapper,e){if(Array.from(wrapper.parentElement.classList).includes("grabbing")){e.preventDefault();const deltaX=current.translateX+e.clientX-mouseX,deltaY=current.translateY+e.clientY-mouseY;updateTransform(wrapper,deltaX,deltaY,getScale(wrapper))}}function handleMouseup(wrapper,e){e.preventDefault(),wrapper.parentElement.classList.remove("grabbing"),mouseX=null,mouseY=null,current=null}function handleWheel(wrapper,e){e.preventDefault();const rect=wrapper.parentElement.getBoundingClientRect(),clientX=e.clientX-rect.left,clientY=e.clientY-rect.top,currentScale=getScale(wrapper),curr=getTranslateXY(wrapper),zoomIn=e.deltaY<0,factor=zoomIn?1+zoomFactor:1-zoomFactor,newScale=Math.max(maxScale,Math.min(minScale,currentScale*factor));if(newScale!==currentScale){const actualFactor=newScale/currentScale,currentTranslateX=clientX-(clientX-curr.translateX)*actualFactor,currentTranslateY=clientY-(clientY-curr.translateY)*actualFactor;wrapper.style.transformOrigin="0 0",updateTransform(wrapper,currentTranslateX,currentTranslateY,newScale)}}function handleTouchstart(wrapper,e){if(e.touches.length===1)touchX=e.touches[0].clientX,touchY=e.touches[0].clientY,wrapper.parentElement.classList.add("grabbing");else if(e.touches.length===2){e.preventDefault(),wrapper.parentElement.classList.remove("grabbing");const touch1=e.touches[0],touch2=e.touches[1];initialDistance=Math.sqrt((touch2.clientX-touch1.clientX)**2+(touch2.clientY-touch1.clientY)**2),initialScale=scale}}function handleTouchmove(wrapper,e){if(e.touches.length===1){if(!Array.from(wrapper.parentElement.classList).includes("grabbing"))return;e.preventDefault();const deltaX=e.touches[0].clientX-(touchX||0),deltaY=e.touches[0].clientY-(touchY||0),c=getTranslateXY(wrapper),translateX=c.translateX+deltaX,translateY=c.translateY+deltaY;touchX=e.touches[0].clientX,touchY=e.touches[0].clientY,updateTransform(wrapper,translateX,translateY,getScale(wrapper))}else if(e.touches.length===2){e.preventDefault();const touch1=e.touches[0],touch2=e.touches[1],c=getTranslateXY(wrapper),currentDistance=Math.sqrt((touch2.clientX-touch1.clientX)**2+(touch2.clientY-touch1.clientY)**2),scale=Math.max(maxScale,Math.min(minScale,initialScale*(currentDistance/initialDistance)));updateTransform(wrapper,c.currentTranslateX,c.currentTranslateY,scale)}}function handleTouchend(wrapper){wrapper.parentElement.classList.remove("grabbing")}document.querySelectorAll(".diagram-wrapper").forEach(wrapper=>{const container=wrapper.parentElement,btnExpand=container.querySelector(".control-btn-expand"),btnZoomOut=container.querySelector(".control-btn-zoom-out"),btnZoomIn=container.querySelector(".control-btn-zoom-in");btnExpand.addEventListener("click",()=>{expand(wrapper)}),btnZoomOut.addEventListener("click",()=>{zoomOut(wrapper)}),btnZoomIn.addEventListener("click",()=>{zoomIn(wrapper)}),container.addEventListener("mousedown",e=>{handleMousedown(wrapper,e)}),container.addEventListener("mousemove",e=>{handleMousemove(wrapper,e)}),document.addEventListener("mouseup",e=>{handleMouseup(wrapper,e)}),container.addEventListener("touchstart",e=>{handleTouchstart(wrapper,e)}),container.addEventListener("touchmove",e=>{handleTouchmove(wrapper,e)}),container.addEventListener("touchend",e=>{handleTouchend(wrapper,e)}),container.addEventListener("wheel",e=>{handleWheel(wrapper,e)})})